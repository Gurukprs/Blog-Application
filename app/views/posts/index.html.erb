<h1>
  <% if @topic %>
    Posts for <%= @topic.name %>
  <% else %>
    All Posts
  <% end %>
</h1>

<% if @topic %>
  <%= link_to "New Post", new_topic_post_path(@topic) %>
<% end %>

<% if @posts.any? %>
  <ul>
    <% @posts.each do |post| %>
      <li>
        <h2><%= link_to post.title, topic_post_path(post.topic, post) %></h2>
        <p><%= truncate(post.body, length: 200) %></p>
        <% unless @topic %>
          <p><strong>Topic:</strong> <%= link_to post.topic.name, topic_posts_path(post.topic) %></p>
        <% end %>
        <% if post.tags.any? %>
          <p><strong>Tags:</strong> <%= post.tags.map { |t| "##{t.name}" }.join(", ") %></p>
        <% end %>
      </li>
    <% end %>
  </ul>
<% else %>
  <% if @topic %>
    <p>No posts yet. <%= link_to "Create the first post", new_topic_post_path(@topic) %>.</p>
  <% else %>
    <p>No posts available.</p>
  <% end %>
<% end %>

<%= link_to "Back to Topics", topics_path %>
